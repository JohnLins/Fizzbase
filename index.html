<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Fizzbase — San Francisco People Search</title>
  <meta name="description" content="Fizzbase is an AI search platform that indexed every person in the Bay Area and mapped how they’re connected." />


  <link rel="icon" type="image/png" href="logo.png">
  <link rel="apple-touch-icon" href="logo.png">

  <!-- Optional: dark / light mode -->
  <link rel="icon" type="image/svg+xml" href="/logo2.svg.svg">



  <style>
    :root{
      --bg:#0b0b0c;
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.62);
      --border:rgba(255,255,255,.14);
      --border2:rgba(255,255,255,.10);
      --radius:16px;
      --max:1080px;

      --panel:rgba(255,255,255,.04);
      --panel2:rgba(255,255,255,.06);
      --shadow:0 22px 80px rgba(0,0,0,.45);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }

    body{
      margin:0;
      background:
        radial-gradient(1100px 700px at 50% 18%, rgba(255,255,255,.10), transparent 55%),
        radial-gradient(900px 600px at 20% 80%, rgba(255,255,255,.06), transparent 60%),
        var(--bg);
      color:var(--text);
      font:16px/1.45 -apple-system, BlinkMacSystemFont, "SF Pro Display", "SF Pro Text",
           Inter, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      letter-spacing:-0.01em;
      overflow-x:hidden;
    }

    a{ color:inherit; text-decoration:none; }
    ::selection{ background: rgba(255,255,255,.18); }

    .wrap{
      min-height:100vh;
      display:flex;
      flex-direction:column;
      align-items:center;
      padding:24px 20px 56px;
      position:relative;
      overflow:hidden;
    }

    /* Nav */
    .nav{
      width:min(var(--max), 100%);
      display:flex;
      align-items:center;
      padding:8px 2px 0;
      z-index:5;
      position:relative;
    }

    .brand{ display:flex; align-items:center; gap:10px; }
    .name{ font-weight:650; letter-spacing:-0.03em; font-size:15px; }

    .palace{
      width:30px; height:30px; display:block;
      opacity:.95;
      filter:drop-shadow(0 10px 18px rgba(0,0,0,.35));
    }
    .palace path, .palace line{
      stroke:rgba(255,255,255,.86);
      stroke-width:1.8;
      fill:none;
      stroke-linecap:round;
      stroke-linejoin:round;
    }
    .palace .soft{ stroke:rgba(255,255,255,.55); stroke-width:1.4; }

    /* Golden Gate accent (unchanged) */
    .gateWrap{
      position:absolute;
      inset:-90px -320px auto auto;
      width:1200px;
      height:820px;
      pointer-events:none;
      opacity:.52;
      filter:saturate(0);
      z-index:1;
      -webkit-mask-image: radial-gradient(900px 600px at 70% 20%, #000 62%, transparent 100%),
                          linear-gradient(to bottom, #000 0%, #000 72%, transparent 100%);
      -webkit-mask-composite: source-in;
              mask-image: radial-gradient(900px 600px at 70% 20%, #000 62%, transparent 100%),
                          linear-gradient(to bottom, #000 0%, #000 72%, transparent 100%);
              mask-composite: intersect;
    }
    .gateGlass{ filter:url(#glassBlur); opacity:.55; }
    .gateStroke{ stroke:rgba(255,255,255,.18); stroke-width:2; fill:none; }
    .gateStroke.bold{ stroke-width:2.8; stroke:rgba(255,255,255,.22); }
    .gateFill{ fill:rgba(255,255,255,.025); }

    @media (max-width:860px){
      .gateWrap{ right:-520px; top:20px; opacity:.44; width:1200px; height:840px; }
    }
    @media (max-width:520px){
      .gateWrap{ right:-620px; top:30px; opacity:.36; width:1200px; height:900px; }
    }
    @media (prefers-reduced-motion: no-preference){
      .gateWrap{ animation: drift 12s ease-in-out infinite; }
      @keyframes drift{
        0%,100%{ transform: translate3d(0,0,0); }
        50%{ transform: translate3d(-10px, 8px, 0); }
      }
    }

    /* ====== HERO / SEARCH STATES ====== */

    .hero{
      width:min(var(--max), 100%);
      margin-top:64px;
      display:flex;
      flex-direction:column;
      align-items:center;
      text-align:center;
      z-index:3;
      position:relative;

      transition: margin-top .45s cubic-bezier(.2,.9,.2,1);
      will-change: margin-top;
    }

    /* In results mode we pin things higher */
    body.results .hero{
      margin-top:18px;
      text-align:left;
      align-items:stretch;
    }

    .heroTop{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:12px;
      transition:
        transform .45s cubic-bezier(.2,.9,.2,1),
        opacity .35s ease,
        max-height .45s cubic-bezier(.2,.9,.2,1),
        margin .45s cubic-bezier(.2,.9,.2,1);
      overflow:hidden;
      max-height:240px;
    }

    body.results .heroTop{
      opacity:0;
      transform: translateY(-10px);
      max-height:0px;
      margin-top:-8px;
      pointer-events:none;
    }

    h1{
      margin:0;
      font-size:clamp(34px, 5.2vw, 56px);
      line-height:1.02;
      letter-spacing:-0.06em;
      font-weight:720;
    }

    .sub{
      margin-top:4px;
      color:var(--muted);
      font-size:16px;
      max-width:62ch;
    }

    /* Search */
    .search{
      margin-top:28px;
      width:min(820px, 100%);
      border-radius:var(--radius);
      border:1px solid rgba(255,255,255,.16);
      background:rgba(255,255,255,.04);
      backdrop-filter:blur(12px);
      -webkit-backdrop-filter:blur(12px);
      display:flex;
      align-items:center;
      padding:10px;
      gap:10px;
      box-shadow:var(--shadow);
      transition:
        margin-top .45s cubic-bezier(.2,.9,.2,1),
        width .45s cubic-bezier(.2,.9,.2,1),
        box-shadow .45s cubic-bezier(.2,.9,.2,1);
    }

    body.results .search{
      margin-top:0px;
      width:min(var(--max), 100%);
      box-shadow:0 12px 40px rgba(0,0,0,.38);
    }

    .spark{
      width:34px; height:34px;
      border-radius:12px;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.14);
      display:grid;
      place-items:center;
      color:rgba(255,255,255,.8);
      flex:0 0 auto;
    }

    input{
      flex:1;
      border:0;
      outline:0;
      background:transparent;
      color:rgba(255,255,255,.92);
      font-size:15px;
      padding:10px 6px;
      letter-spacing:-0.01em;
      min-width:0;
    }
    input::placeholder{ color:rgba(255,255,255,.45); transition:opacity .18s ease; }

    .go{
      padding:10px 14px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.16);
      background:rgba(255,255,255,.92);
      color:rgba(0,0,0,.88);
      font-weight:650;
      letter-spacing:-0.02em;
      cursor:pointer;
      transition:transform .12s ease, filter .12s ease, opacity .2s ease;
      flex:0 0 auto;
    }
    .go:hover{ transform:translateY(-1px); filter:brightness(.98); }
    .go[disabled]{ opacity:.65; cursor:not-allowed; transform:none; }

    /* ====== RESULTS AREA ====== */

    .resultsWrap{
      width:min(var(--max), 100%);
      margin-top:18px;
      z-index:3;
      position:relative;

      opacity:0;
      transform: translateY(10px);
      pointer-events:none;

      transition:
        opacity .35s ease,
        transform .45s cubic-bezier(.2,.9,.2,1);
    }

    body.results .resultsWrap{
      opacity:1;
      transform: translateY(0px);
      pointer-events:auto;
    }

    .metaRow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin:10px 2px 12px;
      color:rgba(255,255,255,.55);
      font-size:13px;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--border2);
      background:rgba(255,255,255,.03);
      color:rgba(255,255,255,.70);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .table{
      border:1px solid var(--border2);
      border-radius:18px;
      overflow:hidden;
      background:rgba(255,255,255,.02);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      box-shadow: 0 20px 70px rgba(0,0,0,.40);
    }

    .row, .head{
      display:grid;
    grid-template-columns:
    72px               /* avatar */
    180px              /* name — FIXED */
    minmax(420px, 1fr) /* socials — gets everything */
    max-content        /* resume */
    120px;             /* contact */


      gap:0;
      align-items:center;
    }

    .head{
      padding:12px 14px;
      background:rgba(255,255,255,.04);
      border-bottom:1px solid var(--border2);
      color:rgba(255,255,255,.62);
      font-size:12px;
      letter-spacing:.02em;
      text-transform:uppercase;
    }

    .row{
      padding:12px 14px;
      border-bottom:1px solid rgba(255,255,255,.06);
      transition: background .18s ease;
    }
    .row:hover{ background:rgba(255,255,255,.03); }
    .row:last-child{ border-bottom:0; }

    .cell{ min-width:0; }

    /* round column */
    .round{
      color:rgba(255,255,255,.55);
      font-variant-numeric: tabular-nums;
      display:flex;
      align-items:center;
      gap:10px;
    }

    .pfp{
      width:34px; height:34px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.16);
      background:rgba(255,255,255,.06);
      overflow:hidden;
      flex:0 0 auto;
      box-shadow: 0 10px 24px rgba(0,0,0,.35);
    }
    .pfp img{
      width:100%; height:100%;
      object-fit:cover;
      display:block;
    }

    /* name column */
    .nameCol{
      display:flex;
      flex-direction:column;
      gap:2px;
      min-width:0;
    }
    .personName{
      font-weight:650;
      letter-spacing:-0.02em;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .desc{
      color:rgba(255,255,255,.50);
      font-size:13px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    /* social chips */
   .socials{
  display:flex;
  flex-wrap:wrap;
  gap:6px;
  align-content:center;
  min-width:0;
}
    .chip{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:7px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.06);
      font-size:13px;
      line-height:1;
      white-space:nowrap;
      color:rgba(255,255,255,.90);
      transition: transform .12s ease, filter .12s ease, background .12s ease;
      max-width:100%;
    }
    .chip:hover{ transform: translateY(-1px); filter: brightness(1.02); }
    .chip .handle{
      opacity:.9;
      max-width:180px;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    /* theme colors per social */
    .chip.linkedin { background: rgba(10,102,194,.22); border-color: rgba(10,102,194,.35); }
    .chip.instagram{ background: rgba(225,48,108,.18); border-color: rgba(225,48,108,.30); }
    .chip.github   { background: rgba(255,255,255,.08); border-color: rgba(255,255,255,.14); }
    .chip.scholar  { background: rgba(66,133,244,.18); border-color: rgba(66,133,244,.30); }
    .chip.site     { background: rgba(52,211,153,.14); border-color: rgba(52,211,153,.26); }

    .icon{
      width:14px; height:14px;
      display:inline-block;
      opacity:.92;
      flex:0 0 auto;
    }

    /* resume link */
    .resume a{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 10px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.04);
      color:rgba(255,255,255,.86);
      font-size:13px;
      transition: transform .12s ease, filter .12s ease;
      max-width:100%;
    }
    .resume a:hover{ transform: translateY(-1px); filter: brightness(1.02); }
    .resume span{
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width:220px;
      display:inline-block;
      opacity:.92;
    }

    /* contact button */
    .contact{
      display:flex;
      justify-content:flex-end;
    }
    .contact a{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:9px 12px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.92);
      color:rgba(0,0,0,.88);
      font-weight:650;
      font-size:13px;
      letter-spacing:-0.01em;
      transition: transform .12s ease, filter .12s ease;
    }
    .contact a:hover{ transform: translateY(-1px); filter:brightness(.98); }

    /* Empty states */
    .empty{
      padding:22px 18px;
      color:rgba(255,255,255,.58);
      font-size:14px;
    }

    .error{
      margin-top:10px;
      padding:12px 14px;
      border-radius:14px;
      border:1px solid rgba(255,90,90,.25);
      background:rgba(255,90,90,.08);
      color:rgba(255,255,255,.86);
      display:none;
    }
    .error.show{ display:block; }

    /* Responsive table */
    @media (max-width:980px){
      .row, .head{
          .row, .head{
    grid-template-columns:
      72px
      minmax(150px, 240px)
      minmax(280px, 1fr)
      max-content
      120px;
  }

      }
      .resume span{ max-width:150px; }
    }

    @media (max-width:760px){
      .head{ display:none; }
      .row{
        grid-template-columns: 1fr;
        gap:10px;
        padding:14px;
      }
      .round{ justify-content:flex-start; }
      .contact{ justify-content:flex-start; }
      .resume span{ max-width:240px; }
    }

    /* Footer */
    .foot{
      margin-top:auto;
      width:min(var(--max), 100%);
      padding-top:22px;
      color:rgba(255,255,255,.34);
      font-size:12px;
      text-align:center;
      border-top:1px solid rgba(255,255,255,.08);
      margin-top:80px;
      z-index:3;
      position:relative;
    }

    /* Respect reduced motion */
    @media (prefers-reduced-motion: reduce){
      *{ transition:none !important; animation:none !important; }
    }



    .addBtn{
  margin-left:auto;
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding:9px 14px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.18);
  background:rgba(255,255,255,.06);
  color:rgba(255,255,255,.92);
  font-size:13px;
  font-weight:600;
  letter-spacing:-0.01em;
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  transition: transform .12s ease, background .12s ease, filter .12s ease;
}

.addBtn:hover{
  transform: translateY(-1px);
  background: rgba(255,255,255,.10);
  filter: brightness(1.03);
}

.addBtn svg{
  width:14px;
  height:14px;
  stroke: currentColor;
  stroke-width:2.2;
  stroke-linecap:round;
  stroke-linejoin:round;
  fill:none;
}

  </style>
</head>

<body>
  <div class="wrap">

    <!-- Golden Gate glass -->
    <div class="gateWrap" aria-hidden="true">
      <svg viewBox="0 0 1000 700">
        <defs>
          <filter id="glassBlur" x="-30%" y="-30%" width="160%" height="160%">
            <feGaussianBlur stdDeviation="3.5" />
          </filter>
          <linearGradient id="fadeOutRight" x1="0" y1="0" x2="1" y2="0">
            <stop offset="0%" stop-color="white" stop-opacity="1"/>
            <stop offset="74%" stop-color="white" stop-opacity="1"/>
            <stop offset="100%" stop-color="white" stop-opacity="0"/>
          </linearGradient>
          <mask id="bridgeFadeRight">
            <rect x="0" y="0" width="1000" height="700" fill="url(#fadeOutRight)" />
          </mask>
        </defs>

        <g class="gateGlass" mask="url(#bridgeFadeRight)" transform="translate(90,80) skewX(-16) rotate(6)">
          <path class="gateStroke bold" d="M60 470 L910 350" />
          <path class="gateStroke" d="M60 492 L910 372" />
          <path class="gateStroke bold" d="M40 305 C210 170, 520 150, 960 255" />
          <path class="gateStroke" d="M40 325 C210 190, 520 170, 960 275" />

          <g>
            <path class="gateStroke bold" d="M315 205 L315 485" />
            <path class="gateStroke bold" d="M390 195 L390 474" />
            <path class="gateStroke" d="M315 205 L390 195" />
            <path class="gateStroke" d="M315 485 L390 474" />
            <path class="gateStroke" d="M315 255 L390 246" />
            <path class="gateStroke" d="M315 315 L390 305" />
            <path class="gateStroke" d="M315 375 L390 364" />
            <path class="gateStroke" d="M315 435 L390 423" />
          </g>

          <g opacity=".95">
            <path class="gateStroke bold" d="M705 160 L705 410" />
            <path class="gateStroke bold" d="M760 152 L760 402" />
            <path class="gateStroke" d="M705 160 L760 152" />
            <path class="gateStroke" d="M705 410 L760 402" />
            <path class="gateStroke" d="M705 205 L760 198" />
            <path class="gateStroke" d="M705 255 L760 247" />
            <path class="gateStroke" d="M705 305 L760 296" />
            <path class="gateStroke" d="M705 355 L760 345" />
          </g>

          <g opacity=".70">
            <path class="gateStroke" d="M120 468 L120 330" />
            <path class="gateStroke" d="M160 463 L160 320" />
            <path class="gateStroke" d="M200 458 L200 308" />
            <path class="gateStroke" d="M240 452 L240 296" />
            <path class="gateStroke" d="M280 447 L280 285" />

            <path class="gateStroke" d="M405 430 L405 250" />
            <path class="gateStroke" d="M440 425 L440 240" />
            <path class="gateStroke" d="M475 420 L475 230" />
            <path class="gateStroke" d="M510 415 L510 225" />
            <path class="gateStroke" d="M545 410 L545 220" />
            <path class="gateStroke" d="M580 405 L580 220" />
            <path class="gateStroke" d="M615 400 L615 223" />
            <path class="gateStroke" d="M650 395 L650 230" />
            <path class="gateStroke" d="M685 390 L685 240" />

            <path class="gateStroke" d="M790 374 L790 262" />
            <path class="gateStroke" d="M830 368 L830 268" />
            <path class="gateStroke" d="M870 362 L870 275" />
            <path class="gateStroke" d="M910 356 L910 282" />
          </g>

          <path class="gateFill" d="M45 500 L930 375 L930 425 L45 552 Z" />
        </g>
      </svg>
    </div>

    <!-- Nav -->
  <div class="nav">
    <a class="brand" href="#" aria-label="Fizzbase home">
      <img src="logo2.svg" style="width: 90px; height: auto"/>
      <span class="name">Fizzbase</span>
    </a>

    <a class="addBtn" href="https://linkedin.com">
      <svg viewBox="0 0 24 24" aria-hidden="true">
        <path d="M12 5v14M5 12h14"/>
      </svg>
      <span>Add yourself</span>
    </a>
  </div>

    <!-- Hero -->
    <main class="hero">
      <div class="heroTop" id="heroTop">
        <h1 style="  font-size: clamp(1.5rem, 6vw, 4rem);
  white-space: nowrap;">Search Engine for People in SF</h1>
        <div class="sub">
          Fizzbase is an AI search platform that indexed every important person in the Bay Area and mapped
          how they’re connected
        </div>
      </div>

      <form class="search" id="searchForm" autocomplete="off">
        <div class="spark" aria-hidden="true">⌕</div>
        <input id="q" type="text" spellcheck="false" aria-label="Search Fizzbase" />
        <button class="go" id="goBtn" type="submit">Search</button>
      </form>

      <div class="error" id="errorBox"></div>
    </main>

    <!-- Results -->
    <section class="resultsWrap" id="resultsWrap" aria-live="polite">
      <div class="metaRow">
        <div class="pill" id="resultCount">0 results</div>
        <div class="pill" id="authPill">Anonymous</div>
      </div>

      <div class="table" id="table">
        <div class="head">
          <div class="cell">Round</div>
          <div class="cell">Name</div>
          <div class="cell">Social</div>
          <div class="cell">Resume</div>
          <div class="cell" style="text-align:right;">Contact</div>
        </div>

        <div id="rows"></div>

        <div class="empty" id="empty" style="display:none;">
          No results yet. Try a different prompt.
        </div>
      </div>
    </section>

    <footer class="foot">
      © <span id="year"></span> Fizzbase
    </footer>
  </div>

  <script>
    // ====== Placeholder rotation (kept) ======
    const examples = [
      "founders connected to YC who hired product leaders from Apple",
      "investors connected to climate startups in SF",
      "engineers who worked at Stripe and studied at Stanford",
      "designers connected to AI labs in the Mission",
      "founders connected to Sequoia and ex-Google PMs"
    ];
    const input = document.getElementById("q");
    let i = 0;

    function setPlaceholder(text){
      if (document.activeElement === input && input.value) return;
      input.placeholder = text;
    }
    setPlaceholder(examples[0]);
    i = 1;
    setInterval(() => {
      setPlaceholder(examples[i]);
      i = (i + 1) % examples.length;
    }, 2600);

    window.addEventListener("load", () => input.focus());
    document.getElementById("year").textContent = new Date().getFullYear();

    // ====== UI helpers ======
    const goBtn = document.getElementById("goBtn");
    const errorBox = document.getElementById("errorBox");
    const rowsEl = document.getElementById("rows");
    const emptyEl = document.getElementById("empty");
    const resultCountEl = document.getElementById("resultCount");
    const authPillEl = document.getElementById("authPill");

    function showError(msg){
      errorBox.textContent = msg;
      errorBox.classList.add("show");
    }
    function clearError(){
      errorBox.textContent = "";
      errorBox.classList.remove("show");
    }

    function setResultsMode(on){
      document.body.classList.toggle("results", !!on);
    }

    // Tiny inline SVG icons (no dependencies)
    const ICONS = {
      linkedin: `<svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M6 9h3v10H6V9Zm1.5-4.5A1.75 1.75 0 1 1 7.5 8a1.75 1.75 0 0 1 0-3.5ZM11 9h2.9v1.4h.04c.4-.76 1.4-1.56 2.88-1.56 3.08 0 3.65 2.02 3.65 4.65V19h-3v-4.75c0-1.13-.02-2.58-1.57-2.58-1.57 0-1.81 1.23-1.81 2.5V19h-3V9Z"
          fill="currentColor"/>
      </svg>`,
      instagram: `<svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M7.5 2h9A5.5 5.5 0 0 1 22 7.5v9A5.5 5.5 0 0 1 16.5 22h-9A5.5 5.5 0 0 1 2 16.5v-9A5.5 5.5 0 0 1 7.5 2Zm9 2h-9A3.5 3.5 0 0 0 4 7.5v9A3.5 3.5 0 0 0 7.5 20h9a3.5 3.5 0 0 0 3.5-3.5v-9A3.5 3.5 0 0 0 16.5 4Zm-4.5 4a4.5 4.5 0 1 1 0 9 4.5 4.5 0 0 1 0-9Zm0 2a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5Zm5.4-2.1a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z"
          fill="currentColor"/>
      </svg>`,
      github: `<svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path fill="currentColor" d="M12 2C6.48 2 2 6.58 2 12.24c0 4.53 2.87 8.38 6.84 9.73.5.1.68-.22.68-.48v-1.7c-2.78.62-3.36-1.1-3.36-1.1-.45-1.2-1.11-1.52-1.11-1.52-.9-.64.07-.63.07-.63 1 .07 1.53 1.06 1.53 1.06.9 1.58 2.36 1.12 2.94.86.09-.66.35-1.12.63-1.38-2.22-.26-4.56-1.15-4.56-5.12 0-1.13.39-2.05 1.03-2.77-.1-.26-.45-1.33.1-2.77 0 0 .84-.28 2.75 1.06.8-.23 1.65-.34 2.5-.34.85 0 1.7.11 2.5.34 1.9-1.34 2.74-1.06 2.74-1.06.56 1.44.21 2.51.1 2.77.64.72 1.03 1.64 1.03 2.77 0 3.98-2.34 4.86-4.57 5.12.36.32.68.95.68 1.92v2.84c0 .27.18.59.69.48A10.2 10.2 0 0 0 22 12.24C22 6.58 17.52 2 12 2Z"/>
      </svg>`,
      scholar: `<svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path fill="currentColor" d="M12 3 1 9l11 6 9-4.91V17h2V9L12 3Zm0 14L4.2 12.8 3 13.45 12 18l9-4.55-1.2-.65L12 17Z"/>
      </svg>`,
      site: `<svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path fill="currentColor" d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm7.94 9h-3.17a15.7 15.7 0 0 0-1.36-5.02A8.03 8.03 0 0 1 19.94 11ZM12 4c.9 0 2.23 1.83 2.9 5H9.1C9.77 5.83 11.1 4 12 4ZM4.06 13h3.17c.25 1.74.74 3.44 1.36 5.02A8.03 8.03 0 0 1 4.06 13Zm3.17-2H4.06a8.03 8.03 0 0 1 4.53-5.02A15.7 15.7 0 0 0 7.23 11ZM12 20c-.9 0-2.23-1.83-2.9-5h5.8c-.67 3.17-2 5-2.9 5Zm3.4-1.98c.62-1.58 1.11-3.28 1.36-5.02h3.17a8.03 8.03 0 0 1-4.53 5.02ZM16.9 11H7.1c.12-1.52.44-3.03.88-4H16c.44.97.76 2.48.9 4Zm-9.8 2h9.8c-.12 1.52-.44 3.03-.88 4H8c-.44-.97-.76-2.48-.9-4Z"/>
      </svg>`,
      doc: `<svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path fill="currentColor" d="M7 2h7l5 5v15a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2Zm7 1.5V8h4.5L14 3.5Z"/>
      </svg>`
    };

    function normalizeUrl(url){
      if (!url) return "";
      // if backend gives "johnlins" etc, try to make it workable
      if (/^https?:\/\//i.test(url)) return url;
      return "https://" + url.replace(/^\/+/, "");
    }

    function buildChip({ kind, label, href }){
      const a = document.createElement("a");
      a.className = `chip ${kind}`;
      a.href = href;
      a.target = "_blank";
      a.rel = "noopener noreferrer";
      a.innerHTML = `${ICONS[kind] || ""}<span class="handle">${label}</span>`;
      return a;
    }

    function renderRows(results){
      rowsEl.innerHTML = "";
      if (!results || results.length === 0){
        emptyEl.style.display = "block";
        return;
      }
      emptyEl.style.display = "none";

      results.forEach((p, idx) => {
        const row = document.createElement("div");
        row.className = "row";

        // round + pfp
        const round = document.createElement("div");
        round.className = "cell round";
        const pfp = document.createElement("div");
        pfp.className = "pfp";
        const img = document.createElement("img");
        img.alt = p.name || "Profile photo";
        img.loading = "lazy";
        img.src = p.pfp_link || "";
        img.onerror = () => { img.remove(); }; // clean fallback (no broken icon)
        pfp.appendChild(img);
        round.appendChild(pfp);

        // const num = document.createElement("span");
        // num.textContent = String(idx + 1).padStart(2, "0");
        // round.appendChild(num);

        // name + description
        const nameCell = document.createElement("div");
        nameCell.className = "cell nameCol";
        const nm = document.createElement("div");
        nm.className = "personName";
        nm.textContent = p.name || "Unknown";
        const ds = document.createElement("div");

        // ds.className = "desc";
        // ds.textContent = p.description || "";
        nameCell.appendChild(nm);
        //nameCell.appendChild(ds);

        // socials
        const socials = document.createElement("div");
        socials.className = "cell socials";

        // Only include if non-empty
        const linkedinUser = (p.linkedin_username || "").trim();
        if (linkedinUser){
          socials.appendChild(buildChip({
            kind: "linkedin",
            label: "@" + linkedinUser,
            href: normalizeUrl("https://www.linkedin.com/in/" + linkedinUser.replace(/^@/,""))
          }));
        }

        const igUser = (p.instagram_username || "").trim();
        if (igUser){
          socials.appendChild(buildChip({
            kind: "instagram",
            label: "@" + igUser,
            href: normalizeUrl("https://www.instagram.com/" + igUser.replace(/^@/,"") + "/")
          }));
        }

        const gh = (p.github_url || "").trim();
        if (gh){
          const handle = gh.replace(/^https?:\/\/(www\.)?github\.com\//i, "").replace(/\/+$/,"");
          socials.appendChild(buildChip({
            kind: "github",
            label: handle.startsWith("@") ? handle : "@" + handle,
            href: normalizeUrl(/^https?:\/\//i.test(gh) ? gh : ("https://github.com/" + handle))
          }));
        }

        const scholar = (p.google_scholar_url || "").trim();
        if (scholar){
          socials.appendChild(buildChip({
            kind: "scholar",
            label: "Scholar",
            href: normalizeUrl(scholar)
          }));
        }

        const site = (p.personal_site_url || "").trim();
        if (site){
          socials.appendChild(buildChip({
            kind: "site",
            label: "Site",
            href: normalizeUrl(site)
          }));
        }

        // resume
        const resume = document.createElement("div");
        resume.className = "cell resume";
        const resumeUrl = (p.resume_url || "").trim();
        if (resumeUrl){
          const a = document.createElement("a");
          a.href = normalizeUrl(resumeUrl);
          a.target = "_blank";
          a.rel = "noopener noreferrer";
          a.innerHTML = `${ICONS.doc}<span>Resume</span>`;
          resume.appendChild(a);
        } else {
          resume.style.color = "rgba(255,255,255,.35)";
          resume.style.fontSize = "13px";
          resume.textContent = "—";
        }

        // contact
        const contact = document.createElement("div");
        contact.className = "cell contact";
        const contactUrl = (p.contact_url || "").trim();
        if (contactUrl){
          const a = document.createElement("a");
          a.href = normalizeUrl(contactUrl);
          a.target = "_blank";
          a.rel = "noopener noreferrer";
          a.textContent = "Contact";
          contact.appendChild(a);
        } else {
          const s = document.createElement("span");
          s.style.color = "rgba(255,255,255,.35)";
          s.style.fontSize = "13px";
          s.textContent = "—";
          contact.appendChild(s);
        }

        row.appendChild(round);
        row.appendChild(nameCell);
        row.appendChild(socials);
        row.appendChild(resume);
        row.appendChild(contact);

        rowsEl.appendChild(row);
      });
    }

    // ====== Search behavior ======
    async function runSearch(prompt){
      clearError();
      goBtn.disabled = true;
      goBtn.textContent = "Searching…";

      try{
        // If you have auth, set firebase_uid here
        const firebase_uid = null; // e.g. window.firebaseUid || null

        const res = await fetch("http://web-production-79f4.up.railway.app/search", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ prompt, firebase_uid })
        });

        const data = await res.json().catch(() => ({}));

        if (!res.ok){
          // Your backend sends {error, message}
          const code = data.error || "ERROR";
          const msg = data.message || "Search failed.";
          if (code === "FREE_LIMIT_REACHED" || code === "AUTH_REQUIRED"){
            showError(msg);
          } else {
            showError(msg);
          }
          setResultsMode(true); // still collapse into results view (feels intentional)
          renderRows([]);
          resultCountEl.textContent = "0 results";
          return;
        }

        const results = data.results || [];
        setResultsMode(true);

        // update pills
        resultCountEl.textContent = `${results.length} results`;
        authPillEl.textContent = data.signed_in ? "Signed in" : "Anonymous";

        renderRows(results);

      } catch (err){
        setResultsMode(true);
        renderRows([]);
        resultCountEl.textContent = "0 results";
        showError("Network error. Is your backend running on localhost:5000?");
      } finally {
        goBtn.disabled = false;
        goBtn.textContent = "Search";
      }
    }

    // Submit handler (no page navigation)
    const form = document.getElementById("searchForm");
    form.addEventListener("submit", (e) => {
      e.preventDefault();
      const q = input.value.trim();
      if (!q) return;
      runSearch(q);
    });

    // Optional: Entering results mode when user hits /search?q=...
    // If you want to support query params without a separate page:
    const params = new URLSearchParams(location.search);
    const qParam = params.get("q");
    if (qParam){
      input.value = qParam;
      runSearch(qParam);
    }
  </script>
</body>
</html>
